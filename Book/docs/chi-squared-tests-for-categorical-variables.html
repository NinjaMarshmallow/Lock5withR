<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Chi-Squared Tests for Categorical Variables | Lock5 With R</title>
  <meta name="description" content="Code, exercises and discussion to accompany a course taught from ‘Statistics: Unlocking the Power of Data’" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Chi-Squared Tests for Categorical Variables | Lock5 With R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Code, exercises and discussion to accompany a course taught from ‘Statistics: Unlocking the Power of Data’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Chi-Squared Tests for Categorical Variables | Lock5 With R" />
  
  <meta name="twitter:description" content="Code, exercises and discussion to accompany a course taught from ‘Statistics: Unlocking the Power of Data’" />
  

<meta name="author" content="R Pruim" />


<meta name="date" content="2019-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inference-for-means-and-proportions.html">
<link rel="next" href="anova-to-compare-means.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Lock5 With R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Lock 5 With R</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html"><i class="fa fa-check"></i>Introduction to R and Statistics</a><ul>
<li class="chapter" data-level="0.1" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#getting-started-with-rstudio"><i class="fa fa-check"></i><b>0.1</b> Getting Started With RStudio</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#loading-packages"><i class="fa fa-check"></i>Loading packages</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#using-r-as-a-calculator"><i class="fa fa-check"></i>Using R as a calculator</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#getting-help-in-rstudio"><i class="fa fa-check"></i><b>0.2</b> Getting Help in RStudio</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#the-rstudio-help-system"><i class="fa fa-check"></i>The RStudio help system</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#history"><i class="fa fa-check"></i>History</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#error-messages"><i class="fa fa-check"></i>Error messages</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#four-things-to-know-about-r"><i class="fa fa-check"></i><b>0.3</b> Four Things to Know About R</a></li>
<li class="chapter" data-level="0.4" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#data-in-r"><i class="fa fa-check"></i><b>0.4</b> Data in R</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#data-in-packages"><i class="fa fa-check"></i>Data in Packages</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#the-helprct-data-set"><i class="fa fa-check"></i>The HELPrct data set</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#using-your-own-data"><i class="fa fa-check"></i>Using your own data</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#the-most-important-template"><i class="fa fa-check"></i><b>0.5</b> The Most Important Template</a></li>
<li class="chapter" data-level="0.6" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#manipulating-your-data"><i class="fa fa-check"></i><b>0.6</b> Manipulating your data</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#creating-a-subset"><i class="fa fa-check"></i>Creating a subset</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#choosing-specific-columns"><i class="fa fa-check"></i>Choosing specific columns</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#dropping-variables"><i class="fa fa-check"></i>Dropping Variables</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#creating-new-variables"><i class="fa fa-check"></i>Creating new variables</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#saving-data"><i class="fa fa-check"></i>Saving Data</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#merging-datasets"><i class="fa fa-check"></i>Merging datasets</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#using-r-markdown"><i class="fa fa-check"></i><b>0.7</b> Using R Markdown</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#r-markdown-files-must-be-self-contained"><i class="fa fa-check"></i>R Markdown files must be self-contained</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#output-formats"><i class="fa fa-check"></i>Output formats</a></li>
</ul></li>
<li class="chapter" data-level="0.8" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#statistics-answering-questions-with-data"><i class="fa fa-check"></i><b>0.8</b> Statistics: Answering Questions With Data</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#data-the-raw-material"><i class="fa fa-check"></i>Data – the raw material</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#information-the-goal"><i class="fa fa-check"></i>Information – the goal</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#uncertainty-the-context"><i class="fa fa-check"></i>Uncertainty – the context</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#probability-the-tool"><i class="fa fa-check"></i>Probability – the tool</a></li>
</ul></li>
<li class="chapter" data-level="0.9" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#a-first-example-the-lady-tasting-tea"><i class="fa fa-check"></i><b>0.9</b> A First Example: The Lady Tasting Tea</a></li>
<li class="chapter" data-level="0.10" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#coins-and-cups"><i class="fa fa-check"></i><b>0.10</b> Coins and Cups</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="collecting-data.html"><a href="collecting-data.html"><i class="fa fa-check"></i><b>1</b> Collecting Data</a><ul>
<li class="chapter" data-level="1.1" data-path="collecting-data.html"><a href="collecting-data.html#the-structure-of-data"><i class="fa fa-check"></i><b>1.1</b> The Structure of Data</a><ul>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#cases-and-variables"><i class="fa fa-check"></i>Cases and Variables</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#categorical-and-quantitative-variables"><i class="fa fa-check"></i>Categorical and Quantitative Variables</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#investigating-variables-and-relationships-between-variables"><i class="fa fa-check"></i>Investigating Variables and Relationships between Variables</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#using-data-to-answer-a-question"><i class="fa fa-check"></i>Using Data to Answer a Question</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="collecting-data.html"><a href="collecting-data.html#sampling-from-a-population"><i class="fa fa-check"></i><b>1.2</b> Sampling from a Population</a><ul>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#samples-from-populations"><i class="fa fa-check"></i>Samples from Populations</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#sampling-bias"><i class="fa fa-check"></i>Sampling Bias</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#simple-random-sample"><i class="fa fa-check"></i>Simple Random Sample</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="collecting-data.html"><a href="collecting-data.html#experiments-and-observational-studies"><i class="fa fa-check"></i><b>1.3</b> Experiments and Observational Studies</a><ul>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#confounding-variables"><i class="fa fa-check"></i>Confounding Variables</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#observational-studies-vs.-experiments"><i class="fa fa-check"></i>Observational Studies vs. Experiments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="describing-data.html"><a href="describing-data.html"><i class="fa fa-check"></i><b>2</b> Describing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="describing-data.html"><a href="describing-data.html#categorical-variables"><i class="fa fa-check"></i><b>2.1</b> Categorical Variables</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#one-categorical-variable"><i class="fa fa-check"></i>One Categorical Variable</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#two-categorical-variables-two-way-tables"><i class="fa fa-check"></i>Two Categorical Variables: Two-Way Tables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="describing-data.html"><a href="describing-data.html#one-quantitative-variable-shape-and-center"><i class="fa fa-check"></i><b>2.2</b> One Quantitative Variable: Shape and Center</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#the-shape-of-a-distribution"><i class="fa fa-check"></i>The Shape of a Distribution</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#the-center-of-a-distribution"><i class="fa fa-check"></i>The Center of a Distribution</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#resistance"><i class="fa fa-check"></i>Resistance</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="describing-data.html"><a href="describing-data.html#one-quantitative-variable-measures-of-spread"><i class="fa fa-check"></i><b>2.3</b> One Quantitative Variable: Measures of Spread</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#standard-deviation"><i class="fa fa-check"></i>Standard Deviation</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#percentiles"><i class="fa fa-check"></i>Percentiles</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#five-number-summary"><i class="fa fa-check"></i>Five Number Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="describing-data.html"><a href="describing-data.html#outliers-boxplots-and-quantitativecategorical-relationships"><i class="fa fa-check"></i><b>2.4</b> Outliers, Boxplots, and Quantitative/Categorical Relationships</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#detection-of-outliers"><i class="fa fa-check"></i>Detection of Outliers</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#boxplots"><i class="fa fa-check"></i>Boxplots</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#one-quantitative-and-one-categorical-variable"><i class="fa fa-check"></i>One Quantitative and One Categorical Variable</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="describing-data.html"><a href="describing-data.html#two-quantitative-variables-scatterplot-and-correlation"><i class="fa fa-check"></i><b>2.5</b> Two Quantitative Variables: Scatterplot and Correlation</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#visualizing-a-relationship-between-two-quantitative-variables-scatterplots"><i class="fa fa-check"></i>Visualizing a Relationship between Two Quantitative Variables: Scatterplots</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#summarizing-a-relationship-between-two-quantitative-variables-correlation"><i class="fa fa-check"></i>Summarizing a Relationship between Two Quantitative Variables: Correlation</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="describing-data.html"><a href="describing-data.html#two-quantitative-variables-linear-regression"><i class="fa fa-check"></i><b>2.6</b> Two Quantitative Variables: Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>3</b> Confidence Intervals</a><ul>
<li class="chapter" data-level="3.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#sampling-distributions"><i class="fa fa-check"></i><b>3.1</b> Sampling Distributions</a><ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#variability-of-sample-statistics"><i class="fa fa-check"></i>Variability of Sample Statistics</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#measuring-sampling-variability-the-standard-error"><i class="fa fa-check"></i>Measuring Sampling Variability: The Standard Error</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#the-importance-of-sample-size"><i class="fa fa-check"></i>The Importance of Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#understanding-and-interpreting-confidence-intervals"><i class="fa fa-check"></i><b>3.2</b> Understanding and Interpreting Confidence Intervals</a><ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#interval-estimates-and-margin-of-error"><i class="fa fa-check"></i>Interval Estimates and Margin of Error</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-1"><i class="fa fa-check"></i>Confidence Intervals</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#understanding-confidence-intervals"><i class="fa fa-check"></i>Understanding Confidence Intervals</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#interpreting-confidence-intervals"><i class="fa fa-check"></i>Interpreting Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#constructing-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>3.3</b> Constructing Bootstrap Confidence Intervals</a><ul>
<li class="chapter" data-level="3.3.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap-samples"><i class="fa fa-check"></i><b>3.3.1</b> Bootstrap Samples</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap-distribution"><i class="fa fa-check"></i>Bootstrap Distribution</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#estimating-standard-error-based-on-a-bootstrap-distribution"><i class="fa fa-check"></i>Estimating Standard Error Based on a Bootstrap Distribution</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-interval-based-on-a-bootstrap-standard-error"><i class="fa fa-check"></i>95% Confidence Interval Based on a Bootstrap Standard Error</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap-confidence-intervals-using-percentiles"><i class="fa fa-check"></i><b>3.4</b> Bootstrap Confidence Intervals Using Percentiles</a><ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-based-on-bootstrap-percentiles"><i class="fa fa-check"></i>Confidence Intervals Based on Bootstrap Percentiles</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#finding-confidence-intervals-for-many-different-parameters"><i class="fa fa-check"></i>Finding Confidence Intervals for Many Different Parameters</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#another-look-at-the-effect-of-sample-size"><i class="fa fa-check"></i>Another Look at the Effect of Sample Size</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#one-caution-on-constructing-bootstrap-confidence-intervals"><i class="fa fa-check"></i>One Caution on Constructing Bootstrap Confidence Intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>4</b> Hypothesis Tests</a><ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#introducing-hypothesis-tests"><i class="fa fa-check"></i><b>4.1</b> Introducing Hypothesis Tests</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#the-4-step-outline"><i class="fa fa-check"></i>The 4-step outline</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#null-and-alternative-hypotheses"><i class="fa fa-check"></i>Null and Alternative Hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#measuring-evidence-with-p-values"><i class="fa fa-check"></i><b>4.2</b> Measuring Evidence with P-values</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#p-values-from-randomization-distributions"><i class="fa fa-check"></i>P-values from Randomization Distributions</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#p-values-and-the-alternative-hypothesis"><i class="fa fa-check"></i>P-values and the Alternative Hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#determining-statisical-significance"><i class="fa fa-check"></i><b>4.3</b> Determining Statisical Significance</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#less-formal-statistical-decisions"><i class="fa fa-check"></i>Less Formal Statistical Decisions</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#creating-randomization-distributions"><i class="fa fa-check"></i><b>4.4</b> Creating Randomization Distributions</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#randomization-test-for-a-difference-in-proportions-cocaine-addiction"><i class="fa fa-check"></i>Randomization Test for a Difference in Proportions: Cocaine Addiction</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#randomization-test-for-a-correlation-malevolent-uniforms-and-penalties"><i class="fa fa-check"></i>Randomization Test for a Correlation: Malevolent Uniforms and Penalties</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#randomization-test-for-a-mean-body-temperature"><i class="fa fa-check"></i>Randomization Test for a Mean: Body Temperature</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#confidence-intervals-and-hypothesis-tests"><i class="fa fa-check"></i><b>4.5</b> Confidence Intervals and Hypothesis Tests</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#randomization-and-bootstrap-distributions"><i class="fa fa-check"></i>Randomization and Bootstrap Distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html"><i class="fa fa-check"></i><b>5</b> Approximating with a Distribution</a><ul>
<li class="chapter" data-level="5.1" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#normal-distributions"><i class="fa fa-check"></i><b>5.1</b> Normal Distributions</a><ul>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#density-curves"><i class="fa fa-check"></i>Density Curves</a></li>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#normal-distributions-1"><i class="fa fa-check"></i>Normal Distributions</a></li>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#finding-normal-probabilities-and-percentiles"><i class="fa fa-check"></i>Finding Normal Probabilities and Percentiles</a></li>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#standard-normal-n01"><i class="fa fa-check"></i>Standard Normal N(0,1)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#confidence-intervals-and-p-values-using-normal-distributions"><i class="fa fa-check"></i><b>5.2</b> Confidence Intervals and P-values Using Normal Distributions</a><ul>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#confidence-intervals-based-on-a-normal-distribution"><i class="fa fa-check"></i>Confidence Intervals Based on a Normal Distribution</a></li>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#p-values-based-on-a-normal-distribution"><i class="fa fa-check"></i>P-values Based on a Normal Distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html"><i class="fa fa-check"></i><b>6</b> Inference for Means and Proportions</a><ul>
<li class="chapter" data-level="6.1" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#distribution-of-a-sample-proportion"><i class="fa fa-check"></i><b>6.1</b> Distribution of a Sample Proportion</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#how-large-a-sample-size-is-needed"><i class="fa fa-check"></i>How Large a Sample Size is Needed?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-single-proportion"><i class="fa fa-check"></i><b>6.2</b> Confidence Interval for a Single Proportion</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-single-proportion-1"><i class="fa fa-check"></i>Confidence Interval for a Single Proportion</a></li>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#determining-sample-size-for-estimating-a-proportion"><i class="fa fa-check"></i>Determining Sample Size for Estimating a Proportion</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#test-for-a-single-proportion"><i class="fa fa-check"></i><b>6.3</b> Test for a Single Proportion</a></li>
<li class="chapter" data-level="6.4" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#distribution-of-a-sample-mean"><i class="fa fa-check"></i><b>6.4</b> Distribution of a Sample Mean</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#computing-the-standard-error"><i class="fa fa-check"></i>Computing the Standard Error</a></li>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#how-large-a-sample-size-is-needed-1"><i class="fa fa-check"></i>How Large a Sample Size is Needed?</a></li>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#the-t-distribution"><i class="fa fa-check"></i>The t-Distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-mean-using-the-t-distribution"><i class="fa fa-check"></i><b>6.5</b> Confidence Interval for a Mean Using the t-Distribution</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-mean-using-the-t-distribution-1"><i class="fa fa-check"></i>Confidence Interval for a Mean Using the t-Distribution</a></li>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#determining-sample-size-for-estimating-a-mean"><i class="fa fa-check"></i>Determining Sample Size for Estimating a Mean</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#test-for-a-single-mean"><i class="fa fa-check"></i><b>6.6</b> Test for a Single Mean</a></li>
<li class="chapter" data-level="6.7" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#distribution-of-differences-in-proportions"><i class="fa fa-check"></i><b>6.7</b> Distribution of Differences in Proportions</a></li>
<li class="chapter" data-level="6.8" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-difference-in-proportions"><i class="fa fa-check"></i><b>6.8</b> Confidence Interval for a Difference in Proportions</a></li>
<li class="chapter" data-level="6.9" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#test-for-a-difference-in-proportions"><i class="fa fa-check"></i><b>6.9</b> Test For a Difference in Proportions</a></li>
<li class="chapter" data-level="6.10" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#distribution-of-differences-in-means"><i class="fa fa-check"></i><b>6.10</b> Distribution of Differences in Means</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#the-t-distribution-1"><i class="fa fa-check"></i>The t-Distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-difference-in-means"><i class="fa fa-check"></i><b>6.11</b> Confidence Interval for a Difference in Means</a></li>
<li class="chapter" data-level="6.12" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#test-for-a-difference-in-means"><i class="fa fa-check"></i><b>6.12</b> Test for a Difference in Means</a></li>
<li class="chapter" data-level="6.13" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#paired-difference-in-means"><i class="fa fa-check"></i><b>6.13</b> Paired Difference in Means</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html"><i class="fa fa-check"></i><b>7</b> Chi-Squared Tests for Categorical Variables</a><ul>
<li class="chapter" data-level="7.1" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#testing-goodness-of-fit-for-a-single-categorical-variable"><i class="fa fa-check"></i><b>7.1</b> Testing Goodness-of-Fit for a Single Categorical Variable</a><ul>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#chi-square-statistic"><i class="fa fa-check"></i>Chi-square Statistic</a></li>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#chi-square-distribution"><i class="fa fa-check"></i>Chi-square Distribution</a></li>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#goodness-of-fit-for-two-categories"><i class="fa fa-check"></i>Goodness-of-Fit for Two Categories</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#testing-for-an-association-between-two-categorical-variables"><i class="fa fa-check"></i><b>7.2</b> Testing for an Association Between Two Categorical Variables</a><ul>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#chi-square-test-for-association"><i class="fa fa-check"></i>Chi-square Test for Association</a></li>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#special-case-for-a-2-x-2-table"><i class="fa fa-check"></i>Special Case for a 2 x 2 Table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html"><i class="fa fa-check"></i><b>8</b> ANOVA to Compare Means</a><ul>
<li class="chapter" data-level="8.1" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#analysis-of-variance"><i class="fa fa-check"></i><b>8.1</b> Analysis of Variance</a><ul>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#null-and-alternative-hypotheses-1"><i class="fa fa-check"></i>Null and Alternative Hypotheses</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#partitioning-variability"><i class="fa fa-check"></i>Partitioning Variability</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#the-f-statistic"><i class="fa fa-check"></i>The F-Statistic</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#the-f-distribution"><i class="fa fa-check"></i>The F-distribution</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#more-examples-of-anova"><i class="fa fa-check"></i>More Examples of ANOVA</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#anova-calculations"><i class="fa fa-check"></i>ANOVA Calculations</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#pairwise-comparisons-and-inference-after-anova"><i class="fa fa-check"></i><b>8.2</b> Pairwise Comparisons and Inference After ANOVA</a><ul>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#using-anova-for-inferences-about-group-means"><i class="fa fa-check"></i>Using ANOVA for Inferences about Group Means</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#lots-of-pairwise-comparisons"><i class="fa fa-check"></i>Lots of Pairwise Comparisons</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lock5 With R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chi-squared-tests-for-categorical-variables" class="section level1">
<h1><span class="header-section-number">7</span> Chi-Squared Tests for Categorical Variables</h1>
<!-- do(10) *  chisq.test(tally( ~ resample(toupper(letters[1:5]), 400) ) )$statistic -->
<!-- rmultinom(10, 400, prob = c(.2, .2, .2, .2, .2)) -->
<p>Goodness of fit tests test how well a distribution fits some hypothesis.</p>
<div id="testing-goodness-of-fit-for-a-single-categorical-variable" class="section level2">
<h2><span class="header-section-number">7.1</span> Testing Goodness-of-Fit for a Single Categorical Variable</h2>
<div id="example-7.1" class="section level4 unnumbered">
<h4>Example 7.1</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tally</span>(<span class="op">~</span>Answer, <span class="dt">format =</span> <span class="st">&quot;proportion&quot;</span>, <span class="dt">data =</span> APMultipleChoice)</code></pre>
<pre><code>## Answer
##      A      B      C      D      E 
## 0.2125 0.2250 0.1975 0.1950 0.1700</code></pre>
<!-- ### Null and Alternative Hypotheses {-} -->
<!-- Example 7.2 -->
<!-- ### Expected Counts {-} -->
<!-- Example 7.3 -->
<!-- Example 7.4 -->
</div>
<div id="chi-square-statistic" class="section level3 unnumbered">
<h3>Chi-square Statistic</h3>
<hr />
<p>The <strong>Chi-squared test statistic</strong>:
<span class="math display">\[
\chi^2 = \sum \frac{(\mbox{observed} - \mbox{expected})^2 }{ \mbox{expected} }
\]</span>
There is one term in this sum <em>for each cell in our data table</em>, and</p>
<p><span class="itemize"></p>
<ul>
<li><p>observed <span class="math inline">\(=\)</span> the tally in that cell (a count from our raw data)</p></li>
<li><p>expected <span class="math inline">\(=\)</span> the number we would “expect” if the percentages followed our null hypothesis exactly. (Note: the expected counts might not be whole numbers.)</p></li>
</ul>
<p></span></p>
<hr />
<div id="example-7.5" class="section level4 unnumbered">
<h4>Example 7.5</h4>
<p>You could calculate the chi-square statistic manually but of course, R can automate this whole process for us if we provide the data table and the null hypothesis. Notice that to use <code>chisq.test()</code>, you must enter the data like answer &lt;- c(85, 90, 79, 78, 68). The default null hypothesis is that all the probabilities are equal.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(APMultipleChoice)</code></pre>
<pre><code>##   Answer
## 1      B
## 2      B
## 3      D
## 4      A
## 5      E
## 6      D</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">answer &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">79</span>, <span class="dv">78</span>, <span class="dv">68</span>)
<span class="kw">chisq.test</span>(answer)</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  answer
## X-squared = 3.425, df = 4, p-value = 0.4894</code></pre>
<!-- #### Figure 7.1 {-} -->
</div>
</div>
<div id="chi-square-distribution" class="section level3 unnumbered">
<h3>Chi-square Distribution</h3>
<p>The <code>chisq()</code> function can be used to calculate a chi-squared statistic from one
of three kinds of input: from the result of <code>chisq.test()</code>, from a table of counts, as
produced by <code>tally()</code>, or from a formula and data frame that could have been the input
to <code>tally()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq</span>(sex <span class="op">~</span><span class="st"> </span>substance, <span class="dt">data =</span> HELPrct)</code></pre>
<pre><code>## X.squared 
##  2.026361</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq</span>(<span class="kw">tally</span>(sex <span class="op">~</span><span class="st"> </span>substance, <span class="dt">data =</span> HELPrct))</code></pre>
<pre><code>## X.squared 
##  2.026361</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq</span>(<span class="kw">chisq.test</span>(<span class="kw">tally</span>(sex <span class="op">~</span><span class="st"> </span>substance, <span class="dt">data =</span> HELPrct)))</code></pre>
<pre><code>## X.squared 
##  2.026361</code></pre>
<div id="figure-7.2" class="section level4 unnumbered">
<h4>Figure 7.2</h4>
<pre class="sourceCode r"><code class="sourceCode r">chisq.sample &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st">  </span><span class="kw">chisq</span>( <span class="op">~</span><span class="st"> </span><span class="kw">resample</span>(<span class="kw">toupper</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]), <span class="dv">400</span>))
<span class="kw">gf_dhistogram</span>(<span class="op">~</span>X.squared, <span class="dt">bins =</span> <span class="dv">11</span>, <span class="dt">data =</span> chisq.sample)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure7.02-1.png" width="65%" /></p>
</div>
<div id="figure-7.3" class="section level4 unnumbered">
<h4>Figure 7.3</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dist</span>(<span class="st">&quot;chisq&quot;</span>, <span class="dt">params =</span> <span class="kw">list</span>(<span class="dt">df =</span> <span class="dv">4</span>), <span class="dt">lty =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_vline</span>(<span class="dt">xintercept =</span> <span class="fl">3.425</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure7.03-1.png" width="65%" /></p>
<!-- AuthNote --- using vline instead of coloring sections, add label for at 3.424 -->
<p>Our test statistic will be large when the observed counts and expected counts are quite different. It will be small when the observed counts and expected counts are quite close. So we will reject when the test statistic is large. To know how large is large enough, we need to know the sampling distribution.</p>
<hr />
<p>If <span class="math inline">\(H_0\)</span> is true and the sample is large enough, then the sampling distribution for the Chi-squared test statistic will be approximately a Chi-squared distribution.</p>
<p><span class="itemize"></p>
<ul>
<li><p>The <strong>degrees of freedom</strong> for this type of goodness of fit test is one less than the number of cells.</p></li>
<li><p>The approximation gets better and better as the sample size gets larger.</p></li>
</ul>
<p></span></p>
<hr />
<p>The mean of a Chi-squared distribution is equal to its degrees of freedom. This can help us get a rough idea about whether our test statistic is unusually large or not.</p>
</div>
<div id="example-7.6" class="section level4 unnumbered">
<h4>Example 7.6</h4>
<p><span class="enumerate"></p>
<ol>
<li><p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(p_w= 0.54\)</span>, <span class="math inline">\(p_b= 0.18\)</span>, <span class="math inline">\(p_h= 0.12\)</span>, <span class="math inline">\(p_a= 0.15\)</span>, <span class="math inline">\(p_o= 0.01\)</span>;</p>
<p><span class="math inline">\(H_a\)</span>: At least one <span class="math inline">\(p_i\)</span> is not as specified.</p></li>
<li><p>Observed count: <span class="math inline">\(w=780\)</span>, <span class="math inline">\(b=117\)</span>, <span class="math inline">\(h=114\)</span>, <span class="math inline">\(a=384\)</span>, <span class="math inline">\(o=58\)</span></p></li>
<li><p>Chi-squared test:</p></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">jury &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">780</span>, <span class="dv">117</span>, <span class="dv">114</span>, <span class="dv">384</span>, <span class="dv">58</span>)
<span class="kw">chisq.test</span>(jury, <span class="dt">p =</span> <span class="kw">c</span>(.<span class="dv">54</span>, <span class="fl">.18</span>, <span class="fl">.12</span>, <span class="fl">.15</span>, <span class="fl">.01</span>))</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  jury
## X-squared = 357.36, df = 4, p-value &lt; 2.2e-16</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xchisq.test</span>(jury, <span class="dt">p =</span> <span class="kw">c</span>(.<span class="dv">54</span>, <span class="fl">.18</span>, <span class="fl">.12</span>, <span class="fl">.15</span>, <span class="fl">.01</span>)) <span class="co"># to list expected counts</span></code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  x
## X-squared = 357.36, df = 4, p-value &lt; 2.2e-16
## 
##  780.00   117.00   114.00   384.00    58.00 
## (784.62) (261.54) (174.36) (217.95) ( 14.53)
## [  0.027] [ 79.880] [ 20.895] [126.509] [130.051]
## &lt;-0.16&gt;  &lt;-8.94&gt;  &lt;-4.57&gt;  &lt;11.25&gt;  &lt;11.40&gt; 
##          
## key:
##  observed
##  (expected)
##  [contribution to X-squared]
##  &lt;Pearson residual&gt;</code></pre>
<p>Notice in this example, we need to tell R what the null hypothesis is.</p>
<p>How unusual is it to get a test statistic at least as large as
ours? We compare to a Chi-squared distribution with 4 degrees of freedom. The mean value of such a statistic is 4, and our test statistic is much larger, so we anticipate that our value is extremely unusual.
</span></p>
<!-- Example 7.7 -->
</div>
</div>
<div id="goodness-of-fit-for-two-categories" class="section level3 unnumbered">
<h3>Goodness-of-Fit for Two Categories</h3>
<p>When there are only two categories, the Chi-squared goodeness of fit test is equivalent to the 1-proportion test. Notice that <code>prop.test()</code> uses the count in one category and total but that <code>chisq.test()</code> uses cell counts.</p>
<div id="example-7.8" class="section level4 unnumbered">
<h4>Example 7.8</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.test</span>(<span class="dv">84</span>, <span class="dv">200</span>)</code></pre>
<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  84 out of 200
## X-squared = 4.805, df = 1, p-value = 0.02838
## alternative hypothesis: true p is not equal to 0.5
## 95 percent confidence interval:
##  0.3513385 0.4917858
## sample estimates:
##    p 
## 0.42</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(<span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">116</span>), <span class="dt">p =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>))</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  c(84, 116)
## X-squared = 5.12, df = 1, p-value = 0.02365</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">binom.test</span>(<span class="dv">84</span>, <span class="dv">200</span>)</code></pre>
<pre><code>## 
## 
## 
## data:  84 out of 200
## number of successes = 84, number of trials = 200, p-value =
## 0.02813
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.3507439 0.4916638
## sample estimates:
## probability of success 
##                   0.42</code></pre>
<p>Although all three tests test the same hypotheses and give similar p-values (in this
example), the binomial test is generally used because
<span class="itemize">
#. The binomial test is exact for all sample sizes while the Chi-squared test and 1-proportion test
are only approximate, and the approximation is poor when sample sizes are small.
#. The binomial test and 1-proportion test also produce confidence intervals.
</span></p>
</div>
</div>
</div>
<div id="testing-for-an-association-between-two-categorical-variables" class="section level2">
<h2><span class="header-section-number">7.2</span> Testing for an Association Between Two Categorical Variables</h2>
<div id="example-7.9" class="section level4 unnumbered">
<h4>Example 7.9</h4>
<pre class="sourceCode r"><code class="sourceCode r">OneTrueLove &lt;-<span class="st"> </span><span class="kw">read.file</span>(<span class="st">&quot;OneTrueLove.csv&quot;</span>)</code></pre>
<pre><code>## Reading data with read.csv()</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tally</span>(<span class="op">~</span>Response, <span class="dt">format =</span> <span class="st">&quot;proportion&quot;</span>, <span class="dt">data =</span> OneTrueLove)</code></pre>
<pre><code>## Response
##      Agree   Disagree Don&#39;t know 
## 0.28000000 0.69028571 0.02971429</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tally</span>(<span class="op">~</span><span class="st"> </span>Response <span class="op">+</span><span class="st"> </span>Gender, <span class="dt">format =</span> <span class="st">&quot;proportion&quot;</span>, <span class="dt">margin =</span> <span class="ot">TRUE</span>, <span class="dt">data =</span> OneTrueLove)</code></pre>
<pre><code>##             Gender
## Response         Female       Male      Total
##   Agree      0.13828571 0.14171429 0.28000000
##   Disagree   0.38285714 0.30742857 0.69028571
##   Don&#39;t know 0.01676190 0.01295238 0.02971429
##   Total      0.53790476 0.46209524 1.00000000</code></pre>
</div>
<div id="figure-7.4" class="section level4 unnumbered">
<h4>Figure 7.4</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_bar</span>(<span class="op">~</span>Response<span class="op">|</span>Gender, <span class="dt">data =</span> OneTrueLove)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure7.04-1.png" width="65%" /></p>
<!-- ### Null and Alternative Hypothesis {-} -->
<!-- ### Expected Counts for a Two-Way Table {-} -->
</div>
<div id="chi-square-test-for-association" class="section level3 unnumbered">
<h3>Chi-square Test for Association</h3>
<div id="example-7.10" class="section level4 unnumbered">
<h4>Example 7.10</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(WaterTaste, <span class="dv">3</span>)</code></pre>
<pre><code>##   Gender Age Class UsuallyDrink FavBotWatBrand Preference First     Second
## 1      F  18     F     Filtered      DEER PARK       CABD  Fiji SamsChoice
## 2      F  18     F          Tap           NONE       CABD  Fiji SamsChoice
## 3      F  18     F          Tap      DEER PARK       CADB  Fiji SamsChoice
##      Third   Fourth    Sex
## 1 Aquafina      Tap Female
## 2 Aquafina      Tap Female
## 3      Tap Aquafina Female</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">water &lt;-<span class="st"> </span><span class="kw">tally</span>(<span class="op">~</span>UsuallyDrink <span class="op">+</span><span class="st"> </span>First, <span class="dt">data =</span> WaterTaste); water</code></pre>
<pre><code>##             First
## UsuallyDrink Aquafina Fiji SamsChoice Tap
##     Bottled        14   15          8   4
##     Filtered        4   10          9   3
##     Tap             7   16          7   3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">water &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">11</span>, <span class="dv">26</span>, <span class="dv">16</span>, <span class="dv">6</span>)) <span class="co"># to combine Tap and Filtered</span>
water</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   14   15    8    4
## [2,]   11   26   16    6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(water) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Aquafina&#39;</span>, <span class="st">&#39;Fiji&#39;</span>, <span class="st">&#39;SamsChoice&#39;</span>, <span class="st">&#39;Tap&#39;</span>) <span class="co"># add column names</span>
<span class="kw">rownames</span>(water) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Bottled&#39;</span>, <span class="st">&#39;Tap/Filtered&#39;</span>) <span class="co"># add row names</span>
water</code></pre>
<pre><code>##              Aquafina Fiji SamsChoice Tap
## Bottled            14   15          8   4
## Tap/Filtered       11   26         16   6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xchisq.test</span>(water)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  x
## X-squared = 3.243, df = 3, p-value = 0.3557
## 
##  14.00    15.00     8.00     4.00  
## (10.25)  (16.81)  ( 9.84)  ( 4.10) 
## [1.3720] [0.1949] [0.3441] [0.0024]
## &lt; 1.171&gt; &lt;-0.441&gt; &lt;-0.587&gt; &lt;-0.049&gt;
##        
##  11.00    26.00    16.00     6.00  
## (14.75)  (24.19)  (14.16)  ( 5.90) 
## [0.9534] [0.1354] [0.2391] [0.0017]
## &lt;-0.976&gt; &lt; 0.368&gt; &lt; 0.489&gt; &lt; 0.041&gt;
##        
## key:
##  observed
##  (expected)
##  [contribution to X-squared]
##  &lt;Pearson residual&gt;</code></pre>
</div>
</div>
<div id="special-case-for-a-2-x-2-table" class="section level3 unnumbered">
<h3>Special Case for a 2 x 2 Table</h3>
<p>There is also an exact test that works only in the case of a <span class="math inline">\(2Ã—\)</span> table (much like the binomial test can be used instead of a goodness of fit test if there are only two categories). The test is called <strong>Fisher’s Exact Test</strong>.</p>
<p>In this case we see that the simulated p-value from the Chi-squared Test is nearly the same as the exact p-value from Fisher’s Exact Test. This is because Fisher’s test is using mathematical formulas to compute probabilities of <em>all</em> randomizations – it is essentially the same as doing infinitely many randomizations!</p>
<p>Note: For a <span class="math inline">\(2Ã—\)</span> table, we could also use the method of 2-proportions (<code>prop.test()</code>, manual resampling, or formula-based). The approximations based on the normal distribution will be poor in the same situations where the Chi-squared test gives a poor approximation.</p>
<div id="example-7.11" class="section level4 unnumbered">
<h4>Example 7.11</h4>
<pre class="sourceCode r"><code class="sourceCode r">SplitStealTable &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">187</span>, <span class="dv">195</span>), <span class="kw">c</span>(<span class="dv">116</span>, <span class="dv">76</span>)); SplitStealTable</code></pre>
<pre><code>##      [,1] [,2]
## [1,]  187  195
## [2,]  116   76</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(SplitStealTable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Split&#39;</span>, <span class="st">&#39;Steal&#39;</span>)
<span class="kw">rownames</span>(SplitStealTable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Younger&#39;</span>, <span class="st">&#39;Older&#39;</span>); SplitStealTable</code></pre>
<pre><code>##         Split Steal
## Younger   187   195
## Older     116    76</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fisher.test</span>(SplitStealTable)</code></pre>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  SplitStealTable
## p-value = 0.01023
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.4346122 0.9065598
## sample estimates:
## odds ratio 
##  0.6288154</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xchisq.test</span>(SplitStealTable)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  x
## X-squared = 6.2857, df = 1, p-value = 0.01217
## 
##  187.00   195.00 
## (201.65) (180.35)
##  [0.99]   [1.11] 
## &lt;-1.03&gt;  &lt; 1.09&gt; 
##    
##  116.00    76.00 
## (101.35) ( 90.65)
##  [1.97]   [2.21] 
## &lt; 1.46&gt;  &lt;-1.54&gt; 
##    
## key:
##  observed
##  (expected)
##  [contribution to X-squared]
##  &lt;Pearson residual&gt;</code></pre>
<p>To use the test for proportions as done in Example 6.23,</p>
<pre class="sourceCode r"><code class="sourceCode r">SplitStealData &lt;-<span class="st"> </span><span class="kw">rbind</span>( 
  <span class="kw">do</span>(<span class="dv">187</span>) <span class="op">*</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">agegroup =</span> <span class="st">&quot;Under40&quot;</span>, <span class="dt">decision =</span> <span class="st">&quot;Split&quot;</span>),
  <span class="kw">do</span>(<span class="dv">195</span>) <span class="op">*</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">agegroup =</span> <span class="st">&quot;Under40&quot;</span>, <span class="dt">decision =</span> <span class="st">&quot;Steal&quot;</span>),
  <span class="kw">do</span>(<span class="dv">116</span>) <span class="op">*</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">agegroup =</span> <span class="st">&quot;Over40&quot;</span>,  <span class="dt">decision =</span> <span class="st">&quot;Split&quot;</span>),
  <span class="kw">do</span>(<span class="dv">76</span>)  <span class="op">*</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">agegroup =</span> <span class="st">&quot;Over40&quot;</span>,  <span class="dt">decision =</span> <span class="st">&quot;Steal&quot;</span>)
  )</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.test</span>(decision <span class="op">~</span><span class="st"> </span>agegroup, <span class="dt">data =</span> SplitStealData)</code></pre>
<pre><code>## 
##  2-sample test for equality of proportions with continuity
##  correction
## 
## data:  tally(decision ~ agegroup)
## X-squared = 6.2857, df = 1, p-value = 0.01217
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  -0.20397777 -0.02529797
## sample estimates:
##    prop 1    prop 2 
## 0.4895288 0.6041667</code></pre>
<!-- ## Goodness of Fit Testing for Simple Hypotheses -->
<!-- This section is currently Unused and has been Deleted-->
<!-- Look back in the source control for this section's code -->

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inference-for-means-and-proportions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova-to-compare-means.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Lock5WithR.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
