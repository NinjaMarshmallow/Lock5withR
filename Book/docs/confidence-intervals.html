<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Confidence Intervals | Lock5 With R</title>
  <meta name="description" content="Code, exercises and discussion to accompany a course taught from ‘Statistics: Unlocking the Power of Data’" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Confidence Intervals | Lock5 With R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Code, exercises and discussion to accompany a course taught from ‘Statistics: Unlocking the Power of Data’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Confidence Intervals | Lock5 With R" />
  
  <meta name="twitter:description" content="Code, exercises and discussion to accompany a course taught from ‘Statistics: Unlocking the Power of Data’" />
  

<meta name="author" content="R Pruim" />


<meta name="date" content="2019-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="describing-data.html">
<link rel="next" href="hypothesis-tests.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Lock5 With R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Lock 5 With R</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html"><i class="fa fa-check"></i>Introduction to R and Statistics</a><ul>
<li class="chapter" data-level="0.1" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#getting-started-with-rstudio"><i class="fa fa-check"></i><b>0.1</b> Getting Started With RStudio</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#loading-packages"><i class="fa fa-check"></i>Loading packages</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#using-r-as-a-calculator"><i class="fa fa-check"></i>Using R as a calculator</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#getting-help-in-rstudio"><i class="fa fa-check"></i><b>0.2</b> Getting Help in RStudio</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#the-rstudio-help-system"><i class="fa fa-check"></i>The RStudio help system</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#history"><i class="fa fa-check"></i>History</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#error-messages"><i class="fa fa-check"></i>Error messages</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#four-things-to-know-about-r"><i class="fa fa-check"></i><b>0.3</b> Four Things to Know About R</a></li>
<li class="chapter" data-level="0.4" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#data-in-r"><i class="fa fa-check"></i><b>0.4</b> Data in R</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#data-in-packages"><i class="fa fa-check"></i>Data in Packages</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#the-helprct-data-set"><i class="fa fa-check"></i>The HELPrct data set</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#using-your-own-data"><i class="fa fa-check"></i>Using your own data</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#the-most-important-template"><i class="fa fa-check"></i><b>0.5</b> The Most Important Template</a></li>
<li class="chapter" data-level="0.6" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#manipulating-your-data"><i class="fa fa-check"></i><b>0.6</b> Manipulating your data</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#creating-a-subset"><i class="fa fa-check"></i>Creating a subset</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#choosing-specific-columns"><i class="fa fa-check"></i>Choosing specific columns</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#dropping-variables"><i class="fa fa-check"></i>Dropping Variables</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#creating-new-variables"><i class="fa fa-check"></i>Creating new variables</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#saving-data"><i class="fa fa-check"></i>Saving Data</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#merging-datasets"><i class="fa fa-check"></i>Merging datasets</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#using-r-markdown"><i class="fa fa-check"></i><b>0.7</b> Using R Markdown</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#r-markdown-files-must-be-self-contained"><i class="fa fa-check"></i>R Markdown files must be self-contained</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#output-formats"><i class="fa fa-check"></i>Output formats</a></li>
</ul></li>
<li class="chapter" data-level="0.8" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#statistics-answering-questions-with-data"><i class="fa fa-check"></i><b>0.8</b> Statistics: Answering Questions With Data</a><ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#data-the-raw-material"><i class="fa fa-check"></i>Data – the raw material</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#information-the-goal"><i class="fa fa-check"></i>Information – the goal</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#uncertainty-the-context"><i class="fa fa-check"></i>Uncertainty – the context</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#probability-the-tool"><i class="fa fa-check"></i>Probability – the tool</a></li>
</ul></li>
<li class="chapter" data-level="0.9" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#a-first-example-the-lady-tasting-tea"><i class="fa fa-check"></i><b>0.9</b> A First Example: The Lady Tasting Tea</a></li>
<li class="chapter" data-level="0.10" data-path="introduction-to-r-and-statistics.html"><a href="introduction-to-r-and-statistics.html#coins-and-cups"><i class="fa fa-check"></i><b>0.10</b> Coins and Cups</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="collecting-data.html"><a href="collecting-data.html"><i class="fa fa-check"></i><b>1</b> Collecting Data</a><ul>
<li class="chapter" data-level="1.1" data-path="collecting-data.html"><a href="collecting-data.html#the-structure-of-data"><i class="fa fa-check"></i><b>1.1</b> The Structure of Data</a><ul>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#cases-and-variables"><i class="fa fa-check"></i>Cases and Variables</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#categorical-and-quantitative-variables"><i class="fa fa-check"></i>Categorical and Quantitative Variables</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#investigating-variables-and-relationships-between-variables"><i class="fa fa-check"></i>Investigating Variables and Relationships between Variables</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#using-data-to-answer-a-question"><i class="fa fa-check"></i>Using Data to Answer a Question</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="collecting-data.html"><a href="collecting-data.html#sampling-from-a-population"><i class="fa fa-check"></i><b>1.2</b> Sampling from a Population</a><ul>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#samples-from-populations"><i class="fa fa-check"></i>Samples from Populations</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#sampling-bias"><i class="fa fa-check"></i>Sampling Bias</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#simple-random-sample"><i class="fa fa-check"></i>Simple Random Sample</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="collecting-data.html"><a href="collecting-data.html#experiments-and-observational-studies"><i class="fa fa-check"></i><b>1.3</b> Experiments and Observational Studies</a><ul>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#confounding-variables"><i class="fa fa-check"></i>Confounding Variables</a></li>
<li class="chapter" data-level="" data-path="collecting-data.html"><a href="collecting-data.html#observational-studies-vs.-experiments"><i class="fa fa-check"></i>Observational Studies vs. Experiments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="describing-data.html"><a href="describing-data.html"><i class="fa fa-check"></i><b>2</b> Describing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="describing-data.html"><a href="describing-data.html#categorical-variables"><i class="fa fa-check"></i><b>2.1</b> Categorical Variables</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#one-categorical-variable"><i class="fa fa-check"></i>One Categorical Variable</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#two-categorical-variables-two-way-tables"><i class="fa fa-check"></i>Two Categorical Variables: Two-Way Tables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="describing-data.html"><a href="describing-data.html#one-quantitative-variable-shape-and-center"><i class="fa fa-check"></i><b>2.2</b> One Quantitative Variable: Shape and Center</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#the-shape-of-a-distribution"><i class="fa fa-check"></i>The Shape of a Distribution</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#the-center-of-a-distribution"><i class="fa fa-check"></i>The Center of a Distribution</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#resistance"><i class="fa fa-check"></i>Resistance</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="describing-data.html"><a href="describing-data.html#one-quantitative-variable-measures-of-spread"><i class="fa fa-check"></i><b>2.3</b> One Quantitative Variable: Measures of Spread</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#standard-deviation"><i class="fa fa-check"></i>Standard Deviation</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#percentiles"><i class="fa fa-check"></i>Percentiles</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#five-number-summary"><i class="fa fa-check"></i>Five Number Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="describing-data.html"><a href="describing-data.html#outliers-boxplots-and-quantitativecategorical-relationships"><i class="fa fa-check"></i><b>2.4</b> Outliers, Boxplots, and Quantitative/Categorical Relationships</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#detection-of-outliers"><i class="fa fa-check"></i>Detection of Outliers</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#boxplots"><i class="fa fa-check"></i>Boxplots</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#one-quantitative-and-one-categorical-variable"><i class="fa fa-check"></i>One Quantitative and One Categorical Variable</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="describing-data.html"><a href="describing-data.html#two-quantitative-variables-scatterplot-and-correlation"><i class="fa fa-check"></i><b>2.5</b> Two Quantitative Variables: Scatterplot and Correlation</a><ul>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#visualizing-a-relationship-between-two-quantitative-variables-scatterplots"><i class="fa fa-check"></i>Visualizing a Relationship between Two Quantitative Variables: Scatterplots</a></li>
<li class="chapter" data-level="" data-path="describing-data.html"><a href="describing-data.html#summarizing-a-relationship-between-two-quantitative-variables-correlation"><i class="fa fa-check"></i>Summarizing a Relationship between Two Quantitative Variables: Correlation</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="describing-data.html"><a href="describing-data.html#two-quantitative-variables-linear-regression"><i class="fa fa-check"></i><b>2.6</b> Two Quantitative Variables: Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>3</b> Confidence Intervals</a><ul>
<li class="chapter" data-level="3.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#sampling-distributions"><i class="fa fa-check"></i><b>3.1</b> Sampling Distributions</a><ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#variability-of-sample-statistics"><i class="fa fa-check"></i>Variability of Sample Statistics</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#measuring-sampling-variability-the-standard-error"><i class="fa fa-check"></i>Measuring Sampling Variability: The Standard Error</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#the-importance-of-sample-size"><i class="fa fa-check"></i>The Importance of Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#understanding-and-interpreting-confidence-intervals"><i class="fa fa-check"></i><b>3.2</b> Understanding and Interpreting Confidence Intervals</a><ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#interval-estimates-and-margin-of-error"><i class="fa fa-check"></i>Interval Estimates and Margin of Error</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-1"><i class="fa fa-check"></i>Confidence Intervals</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#understanding-confidence-intervals"><i class="fa fa-check"></i>Understanding Confidence Intervals</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#interpreting-confidence-intervals"><i class="fa fa-check"></i>Interpreting Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#constructing-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>3.3</b> Constructing Bootstrap Confidence Intervals</a><ul>
<li class="chapter" data-level="3.3.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap-samples"><i class="fa fa-check"></i><b>3.3.1</b> Bootstrap Samples</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap-distribution"><i class="fa fa-check"></i>Bootstrap Distribution</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#estimating-standard-error-based-on-a-bootstrap-distribution"><i class="fa fa-check"></i>Estimating Standard Error Based on a Bootstrap Distribution</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-interval-based-on-a-bootstrap-standard-error"><i class="fa fa-check"></i>95% Confidence Interval Based on a Bootstrap Standard Error</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap-confidence-intervals-using-percentiles"><i class="fa fa-check"></i><b>3.4</b> Bootstrap Confidence Intervals Using Percentiles</a><ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#confidence-intervals-based-on-bootstrap-percentiles"><i class="fa fa-check"></i>Confidence Intervals Based on Bootstrap Percentiles</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#finding-confidence-intervals-for-many-different-parameters"><i class="fa fa-check"></i>Finding Confidence Intervals for Many Different Parameters</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#another-look-at-the-effect-of-sample-size"><i class="fa fa-check"></i>Another Look at the Effect of Sample Size</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#one-caution-on-constructing-bootstrap-confidence-intervals"><i class="fa fa-check"></i>One Caution on Constructing Bootstrap Confidence Intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>4</b> Hypothesis Tests</a><ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#introducing-hypothesis-tests"><i class="fa fa-check"></i><b>4.1</b> Introducing Hypothesis Tests</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#the-4-step-outline"><i class="fa fa-check"></i>The 4-step outline</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#null-and-alternative-hypotheses"><i class="fa fa-check"></i>Null and Alternative Hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#measuring-evidence-with-p-values"><i class="fa fa-check"></i><b>4.2</b> Measuring Evidence with P-values</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#p-values-from-randomization-distributions"><i class="fa fa-check"></i>P-values from Randomization Distributions</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#p-values-and-the-alternative-hypothesis"><i class="fa fa-check"></i>P-values and the Alternative Hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#determining-statisical-significance"><i class="fa fa-check"></i><b>4.3</b> Determining Statisical Significance</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#less-formal-statistical-decisions"><i class="fa fa-check"></i>Less Formal Statistical Decisions</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#creating-randomization-distributions"><i class="fa fa-check"></i><b>4.4</b> Creating Randomization Distributions</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#randomization-test-for-a-difference-in-proportions-cocaine-addiction"><i class="fa fa-check"></i>Randomization Test for a Difference in Proportions: Cocaine Addiction</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#randomization-test-for-a-correlation-malevolent-uniforms-and-penalties"><i class="fa fa-check"></i>Randomization Test for a Correlation: Malevolent Uniforms and Penalties</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#randomization-test-for-a-mean-body-temperature"><i class="fa fa-check"></i>Randomization Test for a Mean: Body Temperature</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#confidence-intervals-and-hypothesis-tests"><i class="fa fa-check"></i><b>4.5</b> Confidence Intervals and Hypothesis Tests</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#randomization-and-bootstrap-distributions"><i class="fa fa-check"></i>Randomization and Bootstrap Distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html"><i class="fa fa-check"></i><b>5</b> Approximating with a Distribution</a><ul>
<li class="chapter" data-level="5.1" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#normal-distributions"><i class="fa fa-check"></i><b>5.1</b> Normal Distributions</a><ul>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#density-curves"><i class="fa fa-check"></i>Density Curves</a></li>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#normal-distributions-1"><i class="fa fa-check"></i>Normal Distributions</a></li>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#finding-normal-probabilities-and-percentiles"><i class="fa fa-check"></i>Finding Normal Probabilities and Percentiles</a></li>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#standard-normal-n01"><i class="fa fa-check"></i>Standard Normal N(0,1)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#confidence-intervals-and-p-values-using-normal-distributions"><i class="fa fa-check"></i><b>5.2</b> Confidence Intervals and P-values Using Normal Distributions</a><ul>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#confidence-intervals-based-on-a-normal-distribution"><i class="fa fa-check"></i>Confidence Intervals Based on a Normal Distribution</a></li>
<li class="chapter" data-level="" data-path="approximating-with-a-distribution.html"><a href="approximating-with-a-distribution.html#p-values-based-on-a-normal-distribution"><i class="fa fa-check"></i>P-values Based on a Normal Distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html"><i class="fa fa-check"></i><b>6</b> Inference for Means and Proportions</a><ul>
<li class="chapter" data-level="6.1" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#distribution-of-a-sample-proportion"><i class="fa fa-check"></i><b>6.1</b> Distribution of a Sample Proportion</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#how-large-a-sample-size-is-needed"><i class="fa fa-check"></i>How Large a Sample Size is Needed?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-single-proportion"><i class="fa fa-check"></i><b>6.2</b> Confidence Interval for a Single Proportion</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-single-proportion-1"><i class="fa fa-check"></i>Confidence Interval for a Single Proportion</a></li>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#determining-sample-size-for-estimating-a-proportion"><i class="fa fa-check"></i>Determining Sample Size for Estimating a Proportion</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#test-for-a-single-proportion"><i class="fa fa-check"></i><b>6.3</b> Test for a Single Proportion</a></li>
<li class="chapter" data-level="6.4" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#distribution-of-a-sample-mean"><i class="fa fa-check"></i><b>6.4</b> Distribution of a Sample Mean</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#computing-the-standard-error"><i class="fa fa-check"></i>Computing the Standard Error</a></li>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#how-large-a-sample-size-is-needed-1"><i class="fa fa-check"></i>How Large a Sample Size is Needed?</a></li>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#the-t-distribution"><i class="fa fa-check"></i>The t-Distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-mean-using-the-t-distribution"><i class="fa fa-check"></i><b>6.5</b> Confidence Interval for a Mean Using the t-Distribution</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-mean-using-the-t-distribution-1"><i class="fa fa-check"></i>Confidence Interval for a Mean Using the t-Distribution</a></li>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#determining-sample-size-for-estimating-a-mean"><i class="fa fa-check"></i>Determining Sample Size for Estimating a Mean</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#test-for-a-single-mean"><i class="fa fa-check"></i><b>6.6</b> Test for a Single Mean</a></li>
<li class="chapter" data-level="6.7" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#distribution-of-differences-in-proportions"><i class="fa fa-check"></i><b>6.7</b> Distribution of Differences in Proportions</a></li>
<li class="chapter" data-level="6.8" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-difference-in-proportions"><i class="fa fa-check"></i><b>6.8</b> Confidence Interval for a Difference in Proportions</a></li>
<li class="chapter" data-level="6.9" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#test-for-a-difference-in-proportions"><i class="fa fa-check"></i><b>6.9</b> Test For a Difference in Proportions</a></li>
<li class="chapter" data-level="6.10" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#distribution-of-differences-in-means"><i class="fa fa-check"></i><b>6.10</b> Distribution of Differences in Means</a><ul>
<li class="chapter" data-level="" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#the-t-distribution-1"><i class="fa fa-check"></i>The t-Distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#confidence-interval-for-a-difference-in-means"><i class="fa fa-check"></i><b>6.11</b> Confidence Interval for a Difference in Means</a></li>
<li class="chapter" data-level="6.12" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#test-for-a-difference-in-means"><i class="fa fa-check"></i><b>6.12</b> Test for a Difference in Means</a></li>
<li class="chapter" data-level="6.13" data-path="inference-for-means-and-proportions.html"><a href="inference-for-means-and-proportions.html#paired-difference-in-means"><i class="fa fa-check"></i><b>6.13</b> Paired Difference in Means</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html"><i class="fa fa-check"></i><b>7</b> Chi-Squared Tests for Categorical Variables</a><ul>
<li class="chapter" data-level="7.1" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#testing-goodness-of-fit-for-a-single-categorical-variable"><i class="fa fa-check"></i><b>7.1</b> Testing Goodness-of-Fit for a Single Categorical Variable</a><ul>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#chi-square-statistic"><i class="fa fa-check"></i>Chi-square Statistic</a></li>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#chi-square-distribution"><i class="fa fa-check"></i>Chi-square Distribution</a></li>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#goodness-of-fit-for-two-categories"><i class="fa fa-check"></i>Goodness-of-Fit for Two Categories</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#testing-for-an-association-between-two-categorical-variables"><i class="fa fa-check"></i><b>7.2</b> Testing for an Association Between Two Categorical Variables</a><ul>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#chi-square-test-for-association"><i class="fa fa-check"></i>Chi-square Test for Association</a></li>
<li class="chapter" data-level="" data-path="chi-squared-tests-for-categorical-variables.html"><a href="chi-squared-tests-for-categorical-variables.html#special-case-for-a-2-x-2-table"><i class="fa fa-check"></i>Special Case for a 2 x 2 Table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html"><i class="fa fa-check"></i><b>8</b> ANOVA to Compare Means</a><ul>
<li class="chapter" data-level="8.1" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#analysis-of-variance"><i class="fa fa-check"></i><b>8.1</b> Analysis of Variance</a><ul>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#null-and-alternative-hypotheses-1"><i class="fa fa-check"></i>Null and Alternative Hypotheses</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#partitioning-variability"><i class="fa fa-check"></i>Partitioning Variability</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#the-f-statistic"><i class="fa fa-check"></i>The F-Statistic</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#the-f-distribution"><i class="fa fa-check"></i>The F-distribution</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#more-examples-of-anova"><i class="fa fa-check"></i>More Examples of ANOVA</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#anova-calculations"><i class="fa fa-check"></i>ANOVA Calculations</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#pairwise-comparisons-and-inference-after-anova"><i class="fa fa-check"></i><b>8.2</b> Pairwise Comparisons and Inference After ANOVA</a><ul>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#using-anova-for-inferences-about-group-means"><i class="fa fa-check"></i>Using ANOVA for Inferences about Group Means</a></li>
<li class="chapter" data-level="" data-path="anova-to-compare-means.html"><a href="anova-to-compare-means.html#lots-of-pairwise-comparisons"><i class="fa fa-check"></i>Lots of Pairwise Comparisons</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lock5 With R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="confidence-intervals" class="section level1">
<h1><span class="header-section-number">3</span> Confidence Intervals</h1>
<div id="sampling-distributions" class="section level2">
<h2><span class="header-section-number">3.1</span> Sampling Distributions</h2>
<p>The key idea in this chapter is the notion of a sampling distribution. Do not confuse it with
the population (what we would like to know about) or the sample (what we actually have data about). If we could repeatedly sample from a population, and if we computed a statistic from each sample, the distribution of those statistics would be the sampling distribution. Sampling distributions tell us how things vary from sample to sample and are the key to interpreting data.</p>
<!-- Example 3.1 -->
<!-- Example 3.2 -->
<!-- Example 3.3 -->
<div id="variability-of-sample-statistics" class="section level3 unnumbered">
<h3>Variability of Sample Statistics</h3>
<div id="example-3.4" class="section level4 unnumbered">
<h4>Example 3.4</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(StatisticsPhD)</code></pre>
<pre><code>##                        University    Department FTGradEnrollment
## 1               Baylor University    Statistics               26
## 2               Boston University Biostatistics               39
## 3                Brown University Biostatistics               21
## 4      Carnegie Mellon University    Statistics               39
## 5 Case Western Reserve University    Statistics               11
## 6       Colorado State University    Statistics               14</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="op">~</span>FTGradEnrollment, <span class="dt">data =</span> StatisticsPhD) <span class="co"># mean enrollment in original population</span></code></pre>
<pre><code>## [1] 53.53659</code></pre>
</div>
<div id="example-3.5" class="section level4 unnumbered">
<h4>Example 3.5</h4>
<p>To select a random sample of a certain size in R we can use the <code>sample()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">sample10 &lt;-<span class="st"> </span><span class="kw">sample</span>(StatisticsPhD, <span class="dv">10</span>); sample10</code></pre>
<pre><code>##                       University    Department FTGradEnrollment orig.id
## 20    Medical College of Georgia Biostatistics               11      20
## 11              Emory University Biostatistics               58      11
## 64        University of Nebraska    Statistics               44      64
## 49         University of Chicago    Statistics              109      49
## 27       Northwestern University    Statistics               12      27
## 35 Southern Methodist University    Statistics               21      35
## 75      University of Washington    Statistics               53      75
## 69       University of Rochester Biostatistics               18      69
## 65  University of North Carolina Biostatistics              118      65
## 28         Ohio State University    Statistics              101      28</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x.bar &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="op">~</span>FTGradEnrollment, <span class="dt">data =</span> sample10); x.bar  <span class="co"># mean enrollment in sample10</span></code></pre>
<pre><code>## [1] 54.5</code></pre>
<p>Note that this sample has been assigned a name to which we can refer back to find the mean of that particular sample.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="op">~</span>FTGradEnrollment, <span class="dt">data =</span> <span class="kw">sample</span>(StatisticsPhD, <span class="dv">10</span>))  <span class="co"># mean enrollment in another sample </span></code></pre>
<pre><code>## [1] 68.9</code></pre>
</div>
<div id="figure-3.1" class="section level4 unnumbered">
<h4>Figure 3.1</h4>
<p>We should check that that our sample distribution has an appropriate shape:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Now we&#39;ll do it 1000 times</span>
Sampledist &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>( <span class="op">~</span><span class="st"> </span>FTGradEnrollment, <span class="dt">data =</span> <span class="kw">sample</span>(StatisticsPhD, <span class="dv">10</span>))
<span class="kw">head</span>(Sampledist, <span class="dv">3</span>)</code></pre>
<pre><code>##   mean
## 1 59.2
## 2 56.0
## 3 68.1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>( <span class="op">~</span><span class="st"> </span>mean, <span class="dt">binwidth =</span> <span class="fl">.9</span>, <span class="dt">data =</span> Sampledist)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.1-1.png" width="65%" /></p>
<!-- AuthNote --- should be count not density -->
<p>In many (but not all) situations, the sampling distribution is
<!-- begin itemize --></p>
<ol>
<li>unimodal,</li>
<li>symmetric, and</li>
<li>bell-shaped (The technical phrase is “approximately normal”.)
<!-- end itemize --></li>
</ol>
</div>
<div id="example-3.6" class="section level4 unnumbered">
<h4>Example 3.6</h4>
<p>This time we don’t have data, but instead we have a summary of the data. We can however, still simulate the sample distribution by using the <code>rflip()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">Sampledist.deg &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rflip</span>(<span class="dv">200</span>, <span class="fl">0.275</span>) <span class="co"># 1000 samples, each of size 200 and proportion 0.275</span>
<span class="kw">head</span>(Sampledist.deg, <span class="dv">3</span>)</code></pre>
<pre><code>##     n heads tails  prop
## 1 200    49   151 0.245
## 2 200    51   149 0.255
## 3 200    45   155 0.225</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>prop, <span class="dt">binwidth =</span> <span class="fl">.002</span>, <span class="dt">data =</span> Sampledist.deg)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Example3.6-1.png" width="65%" /></p>
</div>
</div>
<div id="measuring-sampling-variability-the-standard-error" class="section level3 unnumbered">
<h3>Measuring Sampling Variability: The Standard Error</h3>
<hr />
<p>The standard deviation of a sampling distribution is called the <strong>standard error</strong>,
denoted <span class="math inline">\(SE\)</span>.</p>
<hr />
<p>The standard error is our primary way of measuring how much variability there is from sample statistic to sample statistic, and therefore how precise our estimates are.</p>
<div id="example-3.7" class="section level4 unnumbered">
<h4>Example 3.7</h4>
<p>Calculating the SE is the same as calculating the standard deviation of a sampling distribution, so we use <code>sd()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">SE &lt;-<span class="st"> </span><span class="kw">sd</span>( <span class="op">~</span><span class="st"> </span>mean, <span class="dt">data =</span> Sampledist); SE    <span class="co"># sample from Example 3.5</span></code></pre>
<pre><code>## [1] 10.94816</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">SE2 &lt;-<span class="st"> </span><span class="kw">sd</span>(<span class="op">~</span>prop, <span class="dt">data =</span> Sampledist.deg); SE2     <span class="co"># sample from Example 3.6</span></code></pre>
<pre><code>## [1] 0.03039522</code></pre>
<!-- Example 3.8 -->
</div>
</div>
<div id="the-importance-of-sample-size" class="section level3 unnumbered">
<h3>The Importance of Sample Size</h3>
<div id="example-3.9" class="section level4 unnumbered">
<h4>Example 3.9</h4>
<pre class="sourceCode r"><code class="sourceCode r">Sampledist<span class="fl">.1000</span> &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rflip</span>(<span class="dv">1000</span>, <span class="fl">0.275</span>) <span class="co"># 1000 samples, each of size 1000 and proportion 0.275</span>
Sampledist<span class="fl">.200</span> &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rflip</span>(<span class="dv">200</span>, <span class="fl">0.275</span>)   <span class="co"># 1000 samples, each of size 200 and proportion 0.275</span>
Sampledist<span class="fl">.50</span> &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rflip</span>(<span class="dv">50</span>, <span class="fl">0.275</span>)     <span class="co"># 1000 samples, each of size 50 and proportion 0.275</span></code></pre>
</div>
<div id="figure-3.3" class="section level4 unnumbered">
<h4>Figure 3.3</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>prop, <span class="dt">binwidth =</span> <span class="fl">.0025</span>, <span class="dt">data =</span> Sampledist<span class="fl">.1000</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gf_lims</span>(
  <span class="dt">x =</span> <span class="kw">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">150</span>))</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.3-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>prop, <span class="dt">binwidth =</span> <span class="fl">.003</span>, <span class="dt">data =</span> Sampledist<span class="fl">.200</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gf_lims</span>(
  <span class="dt">x =</span> <span class="kw">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>))</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.3-2.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>prop, <span class="dt">binwidth =</span> <span class="fl">.0015</span>, <span class="dt">data =</span> Sampledist<span class="fl">.50</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gf_lims</span>(
  <span class="dt">x =</span> <span class="kw">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">150</span>))</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.3-3.png" width="65%" /></p>
<!-- Example 3.10 -->
<!-- Example 3.11 -->
</div>
</div>
</div>
<div id="understanding-and-interpreting-confidence-intervals" class="section level2">
<h2><span class="header-section-number">3.2</span> Understanding and Interpreting Confidence Intervals</h2>
<div id="interval-estimates-and-margin-of-error" class="section level3 unnumbered">
<h3>Interval Estimates and Margin of Error</h3>
<hr />
<p>An <strong>interval estimate</strong>
gives a range of plausible values for a population parameter.</p>
<hr />
<p>This is better than a single number (also called a point estimate) because it gives some indication of the precision of the estimate.</p>
<p>One way to express an interval estimate is with a point estimate and a <strong>margin of error</strong>.</p>
<p>We can convert margin of error into an interval by adding and subtracting the margin of error to/from the statistic.</p>
<div id="example-3.12" class="section level4 unnumbered">
<h4>Example 3.12</h4>
<pre class="sourceCode r"><code class="sourceCode r">p.hat &lt;-<span class="st"> </span><span class="fl">0.42</span>                       <span class="co"># sample proportion</span>
MoE &lt;-<span class="st"> </span><span class="fl">0.03</span>                         <span class="co"># margin of error</span>
p.hat <span class="op">-</span><span class="st"> </span>MoE                         <span class="co"># lower limit of interval estimate</span></code></pre>
<pre><code>## [1] 0.39</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p.hat <span class="op">+</span><span class="st"> </span>MoE                         <span class="co"># upper limit of interval estimate</span></code></pre>
<pre><code>## [1] 0.45</code></pre>
</div>
<div id="example-3.13" class="section level4 unnumbered">
<h4>Example 3.13</h4>
<pre class="sourceCode r"><code class="sourceCode r">p.hat &lt;-<span class="st"> </span><span class="fl">0.54</span>                       <span class="co"># sample proportion</span>
MoE &lt;-<span class="st"> </span><span class="fl">0.02</span>                         <span class="co"># margin of error</span>
p.hat <span class="op">-</span><span class="st"> </span>MoE                         <span class="co"># lower limit of interval estimate</span></code></pre>
<pre><code>## [1] 0.52</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p.hat <span class="op">+</span><span class="st"> </span>MoE                         <span class="co"># upper limit of interval estimate</span></code></pre>
<pre><code>## [1] 0.56</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p.hat &lt;-<span class="st"> </span><span class="fl">0.54</span> 
MoE &lt;-<span class="st"> </span><span class="fl">0.10</span>
p.hat <span class="op">-</span><span class="st"> </span>MoE</code></pre>
<pre><code>## [1] 0.44</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p.hat <span class="op">+</span><span class="st"> </span>MoE</code></pre>
<pre><code>## [1] 0.64</code></pre>
</div>
</div>
<div id="confidence-intervals-1" class="section level3 unnumbered">
<h3>Confidence Intervals</h3>
<hr />
<p>A confidence interval for a parameter is an interval computed from sample data
by a method that will capture the parameter for a specified proportion of all
samples</p>
<hr />
<!-- begin enumerate -->
<ol>
<li>The probability of correctly containing the parameter is called the coverage rate or <strong>confidence level</strong>.</li>
<li>So 95% of 95% confidence intervals contain the parameter being estimated.</li>
<li>The margins of error in the tables above were designed to produce 95% confidence intervals.
<!-- end enumerate --></li>
</ol>
<div id="example-3.14" class="section level4 unnumbered">
<h4>Example 3.14</h4>
<pre class="sourceCode r"><code class="sourceCode r">x.bar &lt;-<span class="st"> </span><span class="fl">61.5</span>              <span class="co"># given sample mean</span>
SE &lt;-<span class="st"> </span><span class="dv">11</span>                   <span class="co"># given estimated standard error</span>
MoE &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE; MoE         <span class="co"># margin of error for 95&lt;!--  CI --&gt;</span></code></pre>
<pre><code>## [1] 22</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x.bar <span class="op">-</span><span class="st"> </span>MoE                <span class="co"># lower limit of 95&lt;!--  CI --&gt;</span></code></pre>
<pre><code>## [1] 39.5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x.bar <span class="op">+</span><span class="st"> </span>MoE                <span class="co"># upper limit of 95&lt;!--  CI --&gt;</span></code></pre>
<pre><code>## [1] 83.5</code></pre>
</div>
</div>
<div id="understanding-confidence-intervals" class="section level3 unnumbered">
<h3>Understanding Confidence Intervals</h3>
<div id="example-3.15" class="section level4 unnumbered">
<h4>Example 3.15</h4>
<pre class="sourceCode r"><code class="sourceCode r">SE &lt;-<span class="st"> </span><span class="fl">0.03</span>
p1 &lt;-<span class="st"> </span><span class="fl">0.26</span> 
p2 &lt;-<span class="st"> </span><span class="fl">0.32</span>
p3 &lt;-<span class="st"> </span><span class="fl">0.20</span>
MoE &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p1<span class="op">-</span>MoE</code></pre>
<pre><code>## [1] 0.2</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p1<span class="op">+</span>MoE</code></pre>
<pre><code>## [1] 0.32</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p2<span class="op">-</span>MoE</code></pre>
<pre><code>## [1] 0.26</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p2<span class="op">+</span>MoE</code></pre>
<pre><code>## [1] 0.38</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p3<span class="op">-</span>MoE</code></pre>
<pre><code>## [1] 0.14</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p3<span class="op">+</span>MoE</code></pre>
<pre><code>## [1] 0.26</code></pre>
</div>
<div id="figure-3.12" class="section level4 unnumbered">
<h4>Figure 3.12</h4>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="fl">0.275</span>
SE &lt;-<span class="st"> </span><span class="fl">0.03</span>
MoE &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE
p <span class="op">-</span><span class="st"> </span>MoE</code></pre>
<pre><code>## [1] 0.215</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span>MoE</code></pre>
<pre><code>## [1] 0.335</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>prop, <span class="dt">binwidth =</span> <span class="fl">.002</span>, <span class="dt">dotsize =</span> <span class="fl">.8</span>, <span class="dt">colour =</span> <span class="op">~</span>(<span class="fl">0.215</span> <span class="op">&lt;=</span><span class="st"> </span>prop <span class="op">&amp;</span><span class="st"> </span>prop <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.335</span>), <span class="dt">data =</span> Sampledist.deg, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.12-1.png" width="65%" /></p>
<p>Notice how we defined groups in this dotplot. We are grouping proportions that less than 0.215 and more than 0.335.
<!-- AuthNote --- this is how it was done in the previous tutorial with lattice, would it be better to create a new variable in the data and use that instead? --></p>
</div>
<div id="figure-3.13" class="section level4 unnumbered">
<h4>Figure 3.13</h4>
<p>We can create the data needed for plots like Figure 3.13 using <code>CIsim()</code>.<br />
<!--  The plot itself uses `xYplot()` from the **`Hmisc`** package. --></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">CIsim</span>(<span class="dv">200</span>, <span class="dt">samples =</span> <span class="dv">3</span>, <span class="dt">rdist =</span> rbinom, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.275</span>), 
      <span class="dt">method =</span> binom.test, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">success =</span> <span class="dv">1</span>), 
      <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">estimand =</span> <span class="fl">0.275</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.13-1.png" width="65%" /></p>
<!-- require(Hmisc) -->
<!-- xYplot(Cbind(estimate, lower, upper) ~ sample, -->
<!--   data=results, -->
<!--   par.settings=col.mosaic(),  -->
<!--   groups=cover) -->
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">CIsim</span>(<span class="dv">200</span>, <span class="dt">samples =</span> <span class="dv">100</span>, <span class="dt">rdist =</span> rbinom, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.275</span>), 
      <span class="dt">method =</span> binom.test, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">success =</span> <span class="dv">1</span>), 
      <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">estimand =</span> <span class="fl">0.275</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.13b-1.png" width="65%" /></p>
<!-- require(Hmisc) -->
<!-- xYplot(Cbind(estimate, lower, upper) ~ sample, -->
<!--   data=results, -->
<!--   par.settings=col.mosaic(),  -->
<!--   groups=cover) -->
</div>
</div>
<div id="interpreting-confidence-intervals" class="section level3 unnumbered">
<h3>Interpreting Confidence Intervals</h3>
<div id="example-3.16" class="section level4 unnumbered">
<h4>Example 3.16</h4>
<pre class="sourceCode r"><code class="sourceCode r">x.bar &lt;-<span class="st"> </span><span class="fl">27.655</span>
SE &lt;-<span class="st"> </span><span class="fl">0.009</span>
MoE &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE
x.bar <span class="op">-</span><span class="st"> </span>MoE</code></pre>
<pre><code>## [1] 27.637</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x.bar <span class="op">+</span><span class="st"> </span>MoE</code></pre>
<pre><code>## [1] 27.673</code></pre>
</div>
<div id="example-3.17" class="section level4 unnumbered">
<h4>Example 3.17</h4>
<pre class="sourceCode r"><code class="sourceCode r">diff.x &lt;-<span class="st"> </span><span class="fl">-1.915</span>
SE &lt;-<span class="st"> </span><span class="fl">0.016</span>
MoE &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE
diff.x <span class="op">-</span><span class="st"> </span>MoE</code></pre>
<pre><code>## [1] -1.947</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">diff.x <span class="op">+</span><span class="st"> </span>MoE</code></pre>
<pre><code>## [1] -1.883</code></pre>
<!-- Example 3.18 -->
</div>
</div>
</div>
<div id="constructing-bootstrap-confidence-intervals" class="section level2">
<h2><span class="header-section-number">3.3</span> Constructing Bootstrap Confidence Intervals</h2>
<p>Here’s the clever idea: We don’t have the population, but we have a sample. Probably the sample it similar to the population in many ways. So let’s sample from our sample. We’ll call it <strong>resampling</strong> (also called <strong>bootstrapping</strong>). We want samples the same size as our original sample, so we will need to sample with replacement. This means that we may pick some members of the population more than once and others not at all. We’ll do this many times, however, so each member of our sample will get its fair share. (Notice the similarity to and difference from sampling from populations in the previous sections.)</p>
<div id="figure-3.14" class="section level4 unnumbered">
<h4>Figure 3.14</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span>Time, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">data =</span> CommuteAtlanta)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.14-1.png" width="65%" /></p>
</div>
<div id="bootstrap-samples" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Bootstrap Samples</h3>
<div id="table-3.7" class="section level4 unnumbered">
<h4>Table 3.7</h4>
<p>The computer can easily do all of the resampling by using the <code>resample()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="op">~</span>Time, <span class="dt">data =</span> <span class="kw">resample</span>(CommuteAtlanta)) <span class="co"># mean commute time in one resample</span></code></pre>
<pre><code>## [1] 29.036</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="op">~</span>Time, <span class="dt">data =</span> <span class="kw">resample</span>(CommuteAtlanta)) <span class="co"># mean commute time in another resample</span></code></pre>
<pre><code>## [1] 30.532</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="op">~</span>Time, <span class="dt">data =</span> <span class="kw">resample</span>(CommuteAtlanta))</code></pre>
<pre><code>## [1] 30.15</code></pre>
</div>
</div>
<div id="bootstrap-distribution" class="section level3 unnumbered">
<h3>Bootstrap Distribution</h3>
<div id="figure-3.16" class="section level4 unnumbered">
<h4>Figure 3.16</h4>
<p>The example below uses data from 500 Atlanta commuters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Now we&#39;ll do it 1000 times</span>
Bootstrap &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>( <span class="op">~</span>Time, <span class="dt">data =</span> <span class="kw">resample</span>(CommuteAtlanta))
<span class="kw">head</span>(Bootstrap, <span class="dv">3</span>)</code></pre>
<pre><code>##     mean
## 1 29.890
## 2 28.686
## 3 28.846</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We should check that that our bootstrap distribution has an appropriate shape:</span>
<span class="kw">gf_dotplot</span>( <span class="op">~</span><span class="st"> </span>mean, <span class="dt">binwidth =</span> <span class="fl">0.08</span>, <span class="dt">data =</span> Bootstrap)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.16-1.png" width="65%" /></p>
</div>
<div id="example-3.19" class="section level4 unnumbered">
<h4>Example 3.19</h4>
<pre class="sourceCode r"><code class="sourceCode r">BootP &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rflip</span>(<span class="dv">100</span>, <span class="fl">.52</span>)
<span class="kw">head</span>(BootP, <span class="dv">3</span>)</code></pre>
<pre><code>##     n heads tails prop
## 1 100    48    52 0.48
## 2 100    44    56 0.44
## 3 100    55    45 0.55</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>prop, <span class="dt">binwidth =</span> <span class="fl">.002</span>, <span class="dt">data =</span> BootP)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Example3.19-1.png" width="65%" /></p>
</div>
<div id="example-3.20" class="section level4 unnumbered">
<h4>Example 3.20</h4>
<p>Variables can be created in R using the <code>c()</code> function then collected into
a data frame using the <code>data.frame()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">Laughter &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">NumLaughs =</span>  <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">22</span>, <span class="dv">9</span>, <span class="dv">31</span>, <span class="dv">6</span>, <span class="dv">42</span>) )
<span class="kw">mean</span>( <span class="op">~</span><span class="st"> </span>NumLaughs, <span class="dt">data =</span> Laughter )</code></pre>
<pre><code>## [1] 21</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>( <span class="op">~</span>NumLaughs, <span class="dt">data =</span> <span class="kw">resample</span>(Laughter))</code></pre>
<pre><code>## [1] 24.33333</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>( <span class="op">~</span>NumLaughs, <span class="dt">data =</span> <span class="kw">resample</span>(Laughter))</code></pre>
<pre><code>## [1] 24.5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>( <span class="op">~</span>NumLaughs, <span class="dt">data =</span> <span class="kw">resample</span>(Laughter))</code></pre>
<pre><code>## [1] 16.33333</code></pre>
</div>
</div>
<div id="estimating-standard-error-based-on-a-bootstrap-distribution" class="section level3 unnumbered">
<h3>Estimating Standard Error Based on a Bootstrap Distribution</h3>
<div id="example-3.21" class="section level4 unnumbered">
<h4>Example 3.21</h4>
<p>Since the shape of the bootstrap distribution from Example 3.19 looks good, we can estimate the standard error.</p>
<pre class="sourceCode r"><code class="sourceCode r">SE &lt;-<span class="st"> </span><span class="kw">sd</span>(<span class="op">~</span>prop, <span class="dt">data =</span> BootP); SE</code></pre>
<pre><code>## [1] 0.04831084</code></pre>
</div>
</div>
<div id="confidence-interval-based-on-a-bootstrap-standard-error" class="section level3 unnumbered">
<h3>95% Confidence Interval Based on a Bootstrap Standard Error</h3>
<div id="example-3.22" class="section level4 unnumbered">
<h4>Example 3.22</h4>
<p>We can again use the standard error to compute a 95&lt;!– confidence interval. –&gt;</p>
<pre class="sourceCode r"><code class="sourceCode r">x.bar &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="op">~</span>Time, <span class="dt">data =</span> CommuteAtlanta); x.bar</code></pre>
<pre><code>## [1] 29.11</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">SE &lt;-<span class="st"> </span><span class="kw">sd</span>( <span class="op">~</span><span class="st"> </span>mean, <span class="dt">data =</span> Bootstrap ); SE        <span class="co"># standard error</span></code></pre>
<pre><code>## [1] 0.8695973</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">MoE &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE; MoE                              <span class="co"># margin of error for 95&lt;!--  CI --&gt;</span></code></pre>
<pre><code>## [1] 1.739195</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x.bar <span class="op">-</span><span class="st"> </span>MoE                                     <span class="co"># lower limit of 95&lt;!--  CI --&gt;</span></code></pre>
<pre><code>## [1] 27.37081</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x.bar <span class="op">+</span><span class="st"> </span>MoE                                     <span class="co"># upper limit of 95&lt;!--  CI --&gt;</span></code></pre>
<pre><code>## [1] 30.84919</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p.hat &lt;-<span class="st"> </span><span class="fl">0.52</span>
SE &lt;-<span class="st"> </span><span class="kw">sd</span>( <span class="op">~</span>prop, <span class="dt">data =</span> BootP); SE      </code></pre>
<pre><code>## [1] 0.04831084</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">MoE &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE; MoE                          </code></pre>
<pre><code>## [1] 0.09662168</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p.hat <span class="op">-</span><span class="st"> </span>MoE                                 </code></pre>
<pre><code>## [1] 0.4233783</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p.hat <span class="op">+</span><span class="st"> </span>MoE                                 </code></pre>
<pre><code>## [1] 0.6166217</code></pre>
<p>The steps used in this example get used in a wide variety of confidence interval situations.</p>
<!-- begin enumerate -->
<ol>
<li><p>Compute the statistic from the original sample.</p></li>
<li><p>Create a bootstrap distribution by resampling from the sample.</p>
<p><!-- begin enumerate --></p>
<p><span class="math inline">\(a\)</span> same size samples as the original sample
<span class="math inline">\(b\)</span> with replacement
<span class="math inline">\(c\)</span> compute the statistic for each sample</p>
<p><!-- end enumerate --></p>
<p>The distribution of these statistics is the bootstrap distribution</p></li>
<li><p>Estimate the standard error <span class="math inline">\(SE\)</span> by computing the standard deviation of the bootstrap distribution.</p></li>
<li><p>95% CI is <span class="math display">\[ \mbox{statistic} \pm 2 SE \]</span>
<!-- end enumerate --></p></li>
</ol>
</div>
</div>
</div>
<div id="bootstrap-confidence-intervals-using-percentiles" class="section level2">
<h2><span class="header-section-number">3.4</span> Bootstrap Confidence Intervals Using Percentiles</h2>
<div id="confidence-intervals-based-on-bootstrap-percentiles" class="section level3 unnumbered">
<h3>Confidence Intervals Based on Bootstrap Percentiles</h3>
<div id="example-3.23" class="section level4 unnumbered">
<h4>Example 3.23</h4>
<p>Another way to create a 95% confidence interval is to use the middle 95% of the bootstrap distribution. The <code>cdata()</code> function can compute this for us as follows:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cdata</span>( <span class="op">~</span><span class="st"> </span>mean, <span class="fl">0.95</span>, <span class="dt">data =</span> Bootstrap)</code></pre>
<pre><code>##       low        hi central.p 
##  27.38995  30.81235   0.95000</code></pre>
<p>This is not exactly the same as the interval of the original sample, but it is pretty close.</p>
</div>
<div id="figure-3.22" class="section level4 unnumbered">
<h4>Figure 3.22</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>mean, <span class="dt">binwidth =</span> <span class="fl">.08</span>, <span class="dt">colour =</span> <span class="op">~</span>(<span class="fl">27.43</span> <span class="op">&lt;=</span><span class="st"> </span>mean <span class="op">&amp;</span><span class="st"> </span>mean <span class="op">&lt;=</span><span class="st"> </span><span class="fl">31.05</span>), 
           <span class="dt">data =</span> Bootstrap, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.22-1.png" width="65%" /></p>
<p>Notice the <span style="color:brown">colour=</span> for marking the confidence interval.
<!-- AuthNote --- should a new variable be made? -->
#### Example 3.24 {-}</p>
<p>One advantage of this method is that it is easy to change the confidence level.</p>
<p>To make a 90% and 99% confidence interval, we use the middle 90% and 99% of the sample distribution instead.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cdata</span>(<span class="op">~</span><span class="st"> </span>mean, <span class="fl">0.90</span>, <span class="dt">data =</span> Bootstrap)</code></pre>
<pre><code>##       low        hi central.p 
##   27.6736   30.5386    0.9000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>mean, <span class="dt">binwidth =</span> <span class="fl">.08</span>, <span class="dt">colour =</span> <span class="op">~</span>(<span class="fl">27.70</span> <span class="op">&lt;=</span><span class="st"> </span>mean <span class="op">&amp;</span><span class="st"> </span>mean <span class="op">&lt;=</span><span class="st"> </span><span class="fl">30.71</span>), 
           <span class="dt">data =</span> Bootstrap, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Example3.24-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cdata</span>( <span class="op">~</span><span class="st"> </span>mean, <span class="fl">0.99</span>, <span class="dt">data =</span> Bootstrap)</code></pre>
<pre><code>##       low        hi central.p 
##  26.99799  31.41650   0.99000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>mean, <span class="dt">binwidth =</span> <span class="fl">.08</span>, <span class="dt">colour =</span> <span class="op">~</span>(<span class="fl">26.98</span> <span class="op">&lt;=</span><span class="st"> </span>mean <span class="op">&amp;</span><span class="st"> </span>mean <span class="op">&lt;=</span><span class="st"> </span><span class="fl">31.63</span>), 
           <span class="dt">data =</span> Bootstrap, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Example3.24-2.png" width="65%" /></p>
<!-- AuthNote --- new variable? -->
</div>
</div>
<div id="finding-confidence-intervals-for-many-different-parameters" class="section level3 unnumbered">
<h3>Finding Confidence Intervals for Many Different Parameters</h3>
<div id="figure-3.24" class="section level4 unnumbered">
<h4>Figure 3.24</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_boxplot</span>(Exercise<span class="op">~</span>Gender, <span class="dt">data=</span>ExerciseHours)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.24-1.png" width="65%" /></p>
</div>
<div id="example-3.25" class="section level4 unnumbered">
<h4>Example 3.25</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(ExerciseHours)</code></pre>
<pre><code>##   Year Gender Hand Exercise TV Pulse Pierces
## 1    4      M    l       15  5    57       0
## 2    2      M    l       20 14    70       0
## 3    3      F    r        2  3    70       2
## 4    1      F    l       10  5    66       3
## 5    1      M    r        8  2    62       0
## 6    1      M    r       14 14    62       0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">favstats</span>(<span class="op">~</span>Exercise<span class="op">|</span>Gender, <span class="dt">data =</span> ExerciseHours)</code></pre>
<pre><code>##   Gender min Q1 median    Q3 max mean       sd  n missing
## 1      F   0  3     10 12.00  34  9.4 7.407359 30       0
## 2      M   2  3     12 19.25  30 12.4 8.798325 20       0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">stat &lt;-<span class="st"> </span><span class="kw">diffmean</span>(Exercise<span class="op">~</span>Gender, <span class="dt">data =</span> ExerciseHours); stat</code></pre>
<pre><code>## diffmean 
##        3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">BootE &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">3000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">diffmean</span>(Exercise<span class="op">~</span>Gender, <span class="dt">data =</span> <span class="kw">resample</span>(ExerciseHours))
<span class="kw">head</span>(BootE, <span class="dv">3</span>)</code></pre>
<pre><code>##    diffmean
## 1 5.1166667
## 2 0.6457327
## 3 3.8555008</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cdata</span>( <span class="op">~</span><span class="st"> </span>diffmean, <span class="fl">0.95</span>, <span class="dt">data =</span> BootE)</code></pre>
<pre><code>##       low        hi central.p 
## -1.441927  7.762792  0.950000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>diffmean, <span class="dt">binwidth =</span> <span class="fl">.20</span>, <span class="dt">dotsize =</span> <span class="fl">.45</span>, 
           <span class="dt">colour =</span> <span class="op">~</span>(<span class="op">-</span><span class="fl">1.717</span> <span class="op">&lt;=</span><span class="st"> </span>diffmean <span class="op">&amp;</span><span class="st"> </span>diffmean <span class="op">&lt;=</span><span class="st"> </span><span class="fl">7.633</span>), 
           <span class="dt">xlab =</span> <span class="st">&quot;Difference in mean&quot;</span>, <span class="dt">data =</span> BootE, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Example3.25c-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r">SE &lt;-<span class="st"> </span><span class="kw">sd</span>( <span class="op">~</span><span class="st"> </span>diffmean, <span class="dt">data =</span> BootE); SE</code></pre>
<pre><code>## [1] 2.357225</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">stat <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE</code></pre>
<pre><code>##  diffmean 
## -1.714449</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">stat <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>SE</code></pre>
<pre><code>## diffmean 
## 7.714449</code></pre>
<!-- AuthNote --- original plot used variable 'M' but it was unrecognized. I assumed they wanted to filter 'diffmean', also should be count not density -->
</div>
<div id="figure-3.26" class="section level4 unnumbered">
<h4>Figure 3.26</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_point</span>(Price<span class="op">~</span>Miles, <span class="dt">ylab =</span> <span class="st">&quot;Price ($1000s)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Miles (1000s)&quot;</span>, <span class="dt">data =</span> MustangPrice)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Figure3.26-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(Price<span class="op">~</span>Miles, <span class="dt">data =</span> MustangPrice)</code></pre>
<pre><code>## [1] -0.8246164</code></pre>
</div>
<div id="example-3.26" class="section level4 unnumbered">
<h4>Example 3.26</h4>
<pre class="sourceCode r"><code class="sourceCode r">BootM &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">5000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">cor</span>(Price<span class="op">~</span>Miles, <span class="dt">data =</span> <span class="kw">resample</span>((MustangPrice)))
<span class="kw">head</span>(BootM, <span class="dv">3</span>)</code></pre>
<pre><code>##          cor
## 1 -0.8320238
## 2 -0.7958544
## 3 -0.8020954</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cdata</span>( <span class="op">~</span><span class="st"> </span>cor, <span class="fl">0.98</span>, <span class="dt">data =</span> BootM)</code></pre>
<pre><code>##        low         hi  central.p 
## -0.9371703 -0.7051427  0.9800000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>( <span class="op">~</span><span class="st"> </span>cor, <span class="dt">binwidth =</span> <span class="fl">.002</span>, <span class="dt">colour =</span> <span class="op">~</span>(<span class="op">-</span>.<span class="dv">940</span> <span class="op">&lt;=</span><span class="st"> </span>cor <span class="op">&amp;</span><span class="st"> </span>cor <span class="op">&lt;=</span><span class="st"> </span><span class="fl">-.705</span>), 
         <span class="dt">xlab =</span> <span class="st">&quot;r&quot;</span>, <span class="dt">data =</span> BootM, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Example3.26b-1.png" width="65%" /></p>
</div>
</div>
<div id="another-look-at-the-effect-of-sample-size" class="section level3 unnumbered">
<h3>Another Look at the Effect of Sample Size</h3>
<div id="example-3.27" class="section level4 unnumbered">
<h4>Example 3.27</h4>
<pre class="sourceCode r"><code class="sourceCode r">BootP400 &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">1000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rflip</span>(<span class="dv">400</span>, <span class="fl">.52</span>)
<span class="kw">head</span>(BootP400, <span class="dv">3</span>)</code></pre>
<pre><code>##     n heads tails   prop
## 1 400   197   203 0.4925
## 2 400   206   194 0.5150
## 3 400   194   206 0.4850</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cdata</span>( <span class="op">~</span><span class="st"> </span>prop, <span class="fl">0.95</span>, <span class="dt">data =</span> BootP400)</code></pre>
<pre><code>##       low        hi central.p 
##    0.4700    0.5675    0.9500</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dotplot</span>(<span class="op">~</span><span class="st"> </span>prop, <span class="dt">binwidth =</span> <span class="fl">0.002</span>, <span class="dt">colour =</span> <span class="op">~</span>(<span class="fl">0.472</span> <span class="op">&lt;=</span><span class="st"> </span>prop <span class="op">&amp;</span><span class="st"> </span>prop<span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.568</span>),
           <span class="dt">data =</span> BootP400, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Example3.27-1.png" width="65%" /></p>
</div>
</div>
<div id="one-caution-on-constructing-bootstrap-confidence-intervals" class="section level3 unnumbered">
<h3>One Caution on Constructing Bootstrap Confidence Intervals</h3>
<div id="example-3.28" class="section level4 unnumbered">
<h4>Example 3.28</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(<span class="op">~</span><span class="st"> </span>Price, <span class="dt">data =</span> MustangPrice )</code></pre>
<pre><code>## [1] 11.9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Boot.Mustang &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">5000</span>) <span class="op">*</span><span class="st"> </span><span class="kw">median</span>( <span class="op">~</span>Price, <span class="dt">data =</span> <span class="kw">resample</span>(MustangPrice) )
<span class="kw">head</span>(Boot.Mustang, <span class="dv">3</span>)</code></pre>
<pre><code>##   median
## 1   13.0
## 2   11.9
## 3   11.9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_histogram</span>( <span class="op">~</span><span class="st"> </span>median, <span class="dt">bins =</span> <span class="dv">50</span>, <span class="dt">data =</span> Boot.Mustang)</code></pre>
<p><img src="Lock5WithR_files/figure-html/Example3.28-1.png" width="65%" /></p>
<p>This time the histogram does not have the desired shape. There are two problems:
<!-- begin enumerate --></p>
<ol>
<li>The distribution is not symmetric. (It is right skewed.)</li>
<li>The distribution has spikes and gaps.</li>
</ol>
<p>Since the median must be an element of the sample when the sample size is 25, there are only 25 possible values for the median (and some of these are <em>very</em> unlikely.
<!-- end enumerate --></p>
<p>Since the bootstrap distribution does not look like a normal distribution (bell-shaped, symmetric), we cannot safely use our methods for creating a confidence interval.</p>

<!-- r set_parent('Lock5withR.Rnw') -->
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="describing-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hypothesis-tests.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Lock5WithR.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
